<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Inventory Management (Prototype)</title>
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f6f8fb; }
    .stat-card { min-height:100px; border-radius:12px; color:#fff; }
    .stat-card .value { font-weight:700; font-size:1.3rem; }
    .table-row-actions button { margin-right:6px; }
    .sticky-right { position:sticky; top:20px; }
  </style>
</head>
<body>
<nav class="navbar bg-white shadow-sm mb-4">
  <div class="container-fluid">
    <span class="navbar-brand mb-0 h1">Inventory Management System</span>
    <button class="btn btn-outline-primary" id="btnAddNew">+ Add Product</button>
  </div>
</nav>

<div class="container">
  <div class="row">
    <!-- LEFT: table & search -->
    <div class="col-lg-8">
      <div class="mb-3 d-flex gap-2">
        <input id="searchInput" class="form-control" placeholder="Search by name, SKU or category...">
        <select id="categoryFilter" class="form-select" style="max-width:180px">
          <option value="">All Categories</option>
        </select>
      </div>

      <div class="card shadow-sm mb-3">
        <div class="card-body p-0">
          <table class="table table-hover mb-0">
            <thead class="table-light">
              <tr>
                <th>Product</th>
                <th>SKU</th>
                <th>Category</th>
                <th class="text-end">Qty</th>
                <th class="text-end">Price</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="productsTableBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- RIGHT: stats -->
    <div class="col-lg-4">
      <div class="sticky-right">
        <div class="mb-3 stat-card bg-primary p-3 shadow-sm">
          <div class="small">Total Items</div>
          <div class="value" id="statTotalItems">0</div>
        </div>

        <div class="mb-3 stat-card bg-danger p-3 shadow-sm">
          <div class="small">Low Stock Items</div>
          <div class="value" id="statLowStock">0</div>
        </div>

        <div class="mb-3 stat-card bg-success p-3 shadow-sm">
          <div class="small">Total Inventory Value</div>
          <div class="value" id="statTotalValue">₹0</div>
        </div>

        <div class="mb-3 stat-card bg-info p-3 shadow-sm text-dark">
          <div class="small">Categories</div>
          <div class="value" id="statCategories">0</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Add / Edit Modal -->
<div class="modal fade" id="productModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <form id="productForm">
        <div class="modal-header">
          <h5 class="modal-title" id="modalTitle">Add Product</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="productId">
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Product name</label>
              <input id="name" class="form-control" required>
            </div>
            <div class="col-md-3">
              <label class="form-label">SKU</label>
              <input id="sku" class="form-control" required>
            </div>
            <div class="col-md-3">
              <label class="form-label">Category</label>
              <input id="category" class="form-control" required>
            </div>
            <div class="col-md-3">
              <label class="form-label">Quantity</label>
              <input id="quantity" type="number" min="0" class="form-control" required>
            </div>
            <div class="col-md-3">
              <label class="form-label">Min Quantity</label>
              <input id="minQuantity" type="number" min="0" class="form-control" required>
            </div>
            <div class="col-md-3">
              <label class="form-label">Price (₹)</label>
              <input id="price" type="number" min="0" class="form-control" required>
            </div>
            <div class="col-12">
              <label class="form-label">Description</label>
              <textarea id="description" class="form-control" rows="2"></textarea>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button class="btn btn-primary" type="submit" id="saveBtn">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
/* ========== Sample data & storage ========== */
const sampleData = [
  {id:1, name:"HP ProBook", sku:"LAP002", category:"Electronics", quantity:10, minQuantity:2, price:27899, description:"High-performance business laptop"},
  {id:2, name:"Office Chair", sku:"CHR002", category:"Office Supplies", quantity:3, minQuantity:5, price:2100, description:"Ergonomic office chair"},
  {id:3, name:"Coffee Beans", sku:"COF003", category:"Food & Beverages", quantity:50, minQuantity:10, price:380, description:"Premium arabica coffee beans"},
  {id:4, name:"Tennis Ball", sku:"SMR626", category:"Sports", quantity:10, minQuantity:15, price:280, description:"High quality ball"},
  {id:5, name:"Flower Pots", sku:"FL0929", category:"Home & Garden", quantity:5, minQuantity:5, price:230, description:"Ceramic pots"},
  {id:6, name:"Makeup Kit", sku:"BEA185", category:"Health & Beauty", quantity:5, minQuantity:5, price:2200, description:"Makeup kit"},
  {id:7, name:"RICH DAD and POOR DAD", sku:"B00795", category:"Books", quantity:8, minQuantity:2, price:2150, description:"Motivational book"}
];

let items = [];
const STORAGE_KEY = 'inventoryItems_v1';

/* ========== Helpers ========== */
function loadItems() {
  const raw = localStorage.getItem(STORAGE_KEY);
  if (raw) {
    try { items = JSON.parse(raw); return; } catch(e){}
  }
  items = sampleData.slice();
  saveItems();
}
function saveItems() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(items));
}
function formatCurrency(val){
  return new Intl.NumberFormat('en-IN', { style:'currency', currency:'INR', maximumFractionDigits:0 }).format(val);
}
function statusFor(item){
  return item.quantity <= item.minQuantity ? 'low' : 'in';
}

/* ========== Render UI ========== */
function renderStats(){
  document.getElementById('statTotalItems').textContent = items.length;
  const low = items.filter(i=>i.quantity <= i.minQuantity).length;
  document.getElementById('statLowStock').textContent = low;
  const totalValue = items.reduce((s,i)=> s + (i.price * i.quantity), 0);
  document.getElementById('statTotalValue').textContent = formatCurrency(totalValue);
  const categories = new Set(items.map(i=>i.category));
  document.getElementById('statCategories').textContent = categories.size;
  // populate category filter
  const sel = document.getElementById('categoryFilter');
  const prev = sel.value;
  sel.innerHTML = '<option value="">All Categories</option>';
  [...categories].sort().forEach(c=>{
    const opt = document.createElement('option'); opt.value=c; opt.textContent=c; sel.appendChild(opt);
  });
  sel.value = prev || '';
}

function renderTable(){
  const tbody = document.getElementById('productsTableBody');
  const search = document.getElementById('searchInput').value.trim().toLowerCase();
  const catFilter = document.getElementById('categoryFilter').value;
  tbody.innerHTML = '';
  const filtered = items.filter(i=>{
    const matchSearch = !search || (i.name + ' ' + i.sku + ' ' + i.category + ' ' + (i.description||'')).toLowerCase().includes(search);
    const matchCat = !catFilter || i.category === catFilter;
    return matchSearch && matchCat;
  });
  if (filtered.length === 0) {
    tbody.innerHTML = '<tr><td colspan="7" class="text-center py-3">No products found</td></tr>';
    return;
  }
  filtered.forEach(i=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><strong>${i.name}</strong><div class="small text-muted">${i.description||''}</div></td>
      <td>${i.sku}</td>
      <td>${i.category}</td>
      <td class="text-end">${i.quantity}</td>
      <td class="text-end">${formatCurrency(i.price)}</td>
      <td>${ i.quantity <= i.minQuantity ? '<span class="badge bg-warning text-dark">Low Stock</span>' : '<span class="badge bg-success">In Stock</span>'}</td>
      <td class="table-row-actions">
        <button class="btn btn-sm btn-outline-primary" onclick="openEdit(${i.id})">Edit</button>
        <button class="btn btn-sm btn-outline-danger" onclick="removeItem(${i.id})">Delete</button>
      </td>`;
    tbody.appendChild(tr);
  });
}

/* ========== CRUD Handlers ========== */
const productModal = new bootstrap.Modal(document.getElementById('productModal'));
function openAdd(){
  document.getElementById('modalTitle').textContent = 'Add Product';
  document.getElementById('productForm').reset();
  document.getElementById('productId').value = '';
  productModal.show();
}
function openEdit(id){
  const item = items.find(x=>x.id===id);
  if(!item) return alert('Item not found');
  document.getElementById('modalTitle').textContent = 'Edit Product';
  document.getElementById('productId').value = item.id;
  document.getElementById('name').value = item.name;
  document.getElementById('sku').value = item.sku;
  document.getElementById('category').value = item.category;
  document.getElementById('quantity').value = item.quantity;
  document.getElementById('minQuantity').value = item.minQuantity;
  document.getElementById('price').value = item.price;
  document.getElementById('description').value = item.description||'';
  productModal.show();
}

function removeItem(id){
  if(!confirm('Delete this product?')) return;
  items = items.filter(x=>x.id!==id);
  saveItems();
  renderStats();
  renderTable();
}

document.getElementById('productForm').addEventListener('submit', function(e){
  e.preventDefault();
  const idVal = document.getElementById('productId').value;
  const payload = {
    name: document.getElementById('name').value.trim(),
    sku: document.getElementById('sku').value.trim(),
    category: document.getElementById('category').value.trim(),
    quantity: Number(document.getElementById('quantity').value || 0),
    minQuantity: Number(document.getElementById('minQuantity').value || 0),
    price: Number(document.getElementById('price').value || 0),
    description: document.getElementById('description').value.trim()
  };
  if (!payload.name || !payload.sku){ alert('Name and SKU required'); return; }

  if(idVal){
    // update
    const idx = items.findIndex(i=> i.id == Number(idVal));
    if(idx>=0){ items[idx] = { id: Number(idVal), ...payload }; }
  } else {
    // create
    const newId = Date.now();
    items.push({ id:newId, ...payload });
  }
  saveItems();
  productModal.hide();
  renderStats();
  renderTable();
});

/* ========== UI wiring ========== */
document.getElementById('btnAddNew').addEventListener('click', openAdd);
document.getElementById('searchInput').addEventListener('input', renderTable);
document.getElementById('categoryFilter').addEventListener('change', renderTable);

/* ========== Boot ========== */
loadItems();
renderStats();
renderTable();
</script>
</body>
</html>